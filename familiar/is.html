<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前言 | underscore-analysis</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/underscore-analysis/logo.png">
    <meta name="description" content="underscore源码分析">
    
    <link rel="preload" href="/underscore-analysis/assets/css/0.styles.2cfece8f.css" as="style"><link rel="preload" href="/underscore-analysis/assets/js/app.e2005051.js" as="script"><link rel="preload" href="/underscore-analysis/assets/js/2.f865bfe5.js" as="script"><link rel="preload" href="/underscore-analysis/assets/js/1.33f930c5.js" as="script"><link rel="preload" href="/underscore-analysis/assets/js/26.c97d25ce.js" as="script"><link rel="prefetch" href="/underscore-analysis/assets/js/10.7ee81a4b.js"><link rel="prefetch" href="/underscore-analysis/assets/js/11.bc650de9.js"><link rel="prefetch" href="/underscore-analysis/assets/js/12.e38bac36.js"><link rel="prefetch" href="/underscore-analysis/assets/js/13.9806a85a.js"><link rel="prefetch" href="/underscore-analysis/assets/js/14.24451ea8.js"><link rel="prefetch" href="/underscore-analysis/assets/js/15.f5bf1111.js"><link rel="prefetch" href="/underscore-analysis/assets/js/16.e365312c.js"><link rel="prefetch" href="/underscore-analysis/assets/js/17.9e61cdfb.js"><link rel="prefetch" href="/underscore-analysis/assets/js/18.87da4873.js"><link rel="prefetch" href="/underscore-analysis/assets/js/19.0c5b7f7d.js"><link rel="prefetch" href="/underscore-analysis/assets/js/20.ae853461.js"><link rel="prefetch" href="/underscore-analysis/assets/js/21.fd169144.js"><link rel="prefetch" href="/underscore-analysis/assets/js/22.70fdbf48.js"><link rel="prefetch" href="/underscore-analysis/assets/js/23.d24dcd9c.js"><link rel="prefetch" href="/underscore-analysis/assets/js/24.2a3bad5e.js"><link rel="prefetch" href="/underscore-analysis/assets/js/25.892813a3.js"><link rel="prefetch" href="/underscore-analysis/assets/js/27.3e51aacd.js"><link rel="prefetch" href="/underscore-analysis/assets/js/28.2e6e17ed.js"><link rel="prefetch" href="/underscore-analysis/assets/js/3.84479039.js"><link rel="prefetch" href="/underscore-analysis/assets/js/4.2b3e3d8f.js"><link rel="prefetch" href="/underscore-analysis/assets/js/5.7a467a15.js"><link rel="prefetch" href="/underscore-analysis/assets/js/6.2b881acc.js"><link rel="prefetch" href="/underscore-analysis/assets/js/7.e8f6905e.js"><link rel="prefetch" href="/underscore-analysis/assets/js/vendors~docsearch.5a4296f1.js">
    <link rel="stylesheet" href="/underscore-analysis/assets/css/0.styles.2cfece8f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/underscore-analysis/" class="home-link router-link-active"><!----> <span class="site-name">underscore-analysis</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/underscore-analysis/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://yihan12.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hexo博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="易函123 的 博客" class="dropdown-title"><span class="title">易函123 的 博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="易函123 的 博客" class="mobile-dropdown-title"><span class="title">易函123 的 博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yihan12" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3016715638158381/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/yihan123/articles" target="_blank" rel="noopener noreferrer" class="nav-link external">
  segmentfault
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/yihan123" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/qq_43485006" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/underscore-analysis/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://yihan12.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hexo博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="易函123 的 博客" class="dropdown-title"><span class="title">易函123 的 博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="易函123 的 博客" class="mobile-dropdown-title"><span class="title">易函123 的 博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yihan12" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/3016715638158381/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/yihan123/articles" target="_blank" rel="noopener noreferrer" class="nav-link external">
  segmentfault
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/yihan123" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/qq_43485006" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>写在最前面</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/underscore-analysis/start/" class="sidebar-link">写在最前面</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>熟知的方法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/underscore-analysis/familiar/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/underscore-analysis/familiar/is.html" aria-current="page" class="active sidebar-link">类型判断</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#概览" class="sidebar-link">概览</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isobject" class="sidebar-link">isObject</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isnull" class="sidebar-link">isNull</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isundefined" class="sidebar-link">isUndefined</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isboolean" class="sidebar-link">isBoolean</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#iselement" class="sidebar-link">isElement</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#function-tagtester" class="sidebar-link">function tagTester</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isstring" class="sidebar-link">isString</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isnumber" class="sidebar-link">isNumber</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isdate" class="sidebar-link">isDate</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isregexp" class="sidebar-link">isRegExp</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#iserror" class="sidebar-link">isError</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#issymbol" class="sidebar-link">isSymbol</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isarraybuffer" class="sidebar-link">isArrayBuffer</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isfunction" class="sidebar-link">isFunction</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isdataview" class="sidebar-link">isDataView</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isarray" class="sidebar-link">isArray</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isfunction-2" class="sidebar-link">isFunction</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isarguments" class="sidebar-link">isArguments</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isfinite" class="sidebar-link">isFinite</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isnan" class="sidebar-link">isNaN</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#istypedarray" class="sidebar-link">isTypedArray</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isempty" class="sidebar-link">isEmpty</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#ismatch" class="sidebar-link">isMatch</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isequal" class="sidebar-link">isEqual</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#ismap" class="sidebar-link">isMap</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isweakmap" class="sidebar-link">isWeakMap</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isset" class="sidebar-link">isSet</a></li><li class="sidebar-sub-header"><a href="/underscore-analysis/familiar/is.html#isweakset" class="sidebar-link">isWeakSet</a></li></ul></li><li><a href="/underscore-analysis/familiar/restArguments.html" class="sidebar-link">restArguments</a></li><li><a href="/underscore-analysis/familiar/debounce-u.html" class="sidebar-link">防抖-underscore</a></li><li><a href="/underscore-analysis/familiar/debounce.html" class="sidebar-link">防抖</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="概览"><a href="#概览" class="header-anchor">#</a> 概览</h2> <p>一个个看看下列判断类型的方法，和我们常规判断类型的<code>typeof</code> <code>Object.prototype.toString.call()</code>的区别。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> _ <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">isObject</span><span class="token operator">:</span> isObject<span class="token punctuation">,</span>
  <span class="token literal-property property">isNull</span><span class="token operator">:</span> isNull<span class="token punctuation">,</span>
  <span class="token literal-property property">isUndefined</span><span class="token operator">:</span> isUndefined<span class="token punctuation">,</span>
  <span class="token literal-property property">isBoolean</span><span class="token operator">:</span> isBoolean<span class="token punctuation">,</span>
  <span class="token literal-property property">isElement</span><span class="token operator">:</span> isElement<span class="token punctuation">,</span>
  <span class="token literal-property property">isString</span><span class="token operator">:</span> isString<span class="token punctuation">,</span>
  <span class="token literal-property property">isNumber</span><span class="token operator">:</span> isNumber<span class="token punctuation">,</span>
  <span class="token literal-property property">isDate</span><span class="token operator">:</span> isDate<span class="token punctuation">,</span>
  <span class="token literal-property property">isRegExp</span><span class="token operator">:</span> isRegExp<span class="token punctuation">,</span>
  <span class="token literal-property property">isError</span><span class="token operator">:</span> isError<span class="token punctuation">,</span>
  <span class="token literal-property property">isSymbol</span><span class="token operator">:</span> isSymbol<span class="token punctuation">,</span>
  <span class="token literal-property property">isArrayBuffer</span><span class="token operator">:</span> isArrayBuffer<span class="token punctuation">,</span>
  <span class="token literal-property property">isDataView</span><span class="token operator">:</span> isDataView$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isArray</span><span class="token operator">:</span> isArray<span class="token punctuation">,</span>
  <span class="token literal-property property">isFunction</span><span class="token operator">:</span> isFunction$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isArguments</span><span class="token operator">:</span> isArguments$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isFinite</span><span class="token operator">:</span> isFinite$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isNaN</span><span class="token operator">:</span> isNaN$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isTypedArray</span><span class="token operator">:</span> isTypedArray$1<span class="token punctuation">,</span>
  <span class="token literal-property property">isEmpty</span><span class="token operator">:</span> isEmpty<span class="token punctuation">,</span>
  <span class="token literal-property property">isMatch</span><span class="token operator">:</span> isMatch<span class="token punctuation">,</span>
  <span class="token literal-property property">isEqual</span><span class="token operator">:</span> isEqual<span class="token punctuation">,</span>
  <span class="token literal-property property">isMap</span><span class="token operator">:</span> isMap<span class="token punctuation">,</span>
  <span class="token literal-property property">isWeakMap</span><span class="token operator">:</span> isWeakMap<span class="token punctuation">,</span>
  <span class="token literal-property property">isSet</span><span class="token operator">:</span> isSet<span class="token punctuation">,</span>
  <span class="token literal-property property">isWeakSet</span><span class="token operator">:</span> isWeakSet<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="isobject"><a href="#isobject" class="header-anchor">#</a> isObject</h2> <blockquote><p>判断是否对象</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 判断是否是对象</span>
<span class="token keyword">function</span> <span class="token function">isObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> obj
  <span class="token keyword">return</span> type <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>obj<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><code>typeof</code> 返回为’function‘</li> <li><code>typeof</code> 返回为'object'并且<code>!!obj</code>，这个条件主要是排出 <code>null</code></li></ul> <p>相关示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>通过下面的示例，不难看出：</p> <ol><li>函数和数组属于对象。null 不是对象。</li> <li>1 不属于对象 <code>new Number()</code>属于对象</li> <li>‘1’不属于对象 <code>new String()</code>属于对象</li> <li>true 不属于对象 <code>new Boolean()</code>属于对象</li></ol> <h2 id="isnull"><a href="#isnull" class="header-anchor">#</a> isNull</h2> <blockquote><p>null 虽然 typeof，返回是'object'，但是它还是属于 null 类型，如何判断呢。</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 判断是否为null</span>
<span class="token comment">// Is a given value equal to null?</span>
<span class="token keyword">function</span> <span class="token function">isNull</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">===</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>相关示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>_<span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span> <span class="token boolean">true</span>
_<span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span> <span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="isundefined"><a href="#isundefined" class="header-anchor">#</a> isUndefined</h2> <blockquote><p>既然 null 使用全等判断的，那么 <code>undefined</code> 为何是全等 <code>void 0</code></p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Is a given variable undefined?</span>
<span class="token comment">// 判断是否为undefined</span>
<span class="token keyword">function</span> <span class="token function">isUndefined</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>相关示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>_<span class="token punctuation">.</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>missingVariable<span class="token punctuation">)</span><span class="token punctuation">;</span>
_<span class="token punctuation">.</span><span class="token function">isUndefined</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">=&gt;</span> <span class="token boolean">true</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">undefined</span> <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">undefined</span> <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">undefined</span> <span class="token operator">===</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>void</code> 运算符能对给定的表达式进行求值，然后返回 <code>undefined</code>。</p> <h2 id="isboolean"><a href="#isboolean" class="header-anchor">#</a> isBoolean</h2> <blockquote><p>判断是否为 Boolean</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 判断是否为Boolean</span>
<span class="token keyword">function</span> <span class="token function">isBoolean</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    obj <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">||</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Boolean]'</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>思考：为啥不直接用<code>toString.call(obj) === '[object Boolean]')</code>?</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Proto <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Proto</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '[object Boolean]'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Proto</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '[object Boolean]'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Proto</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '[object Boolean]'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">===</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">===</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Boolean {false}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>对于<code>new Boolean</code> <code>typeof</code>返回的是对象。但是<code>Object.prototype.toString.call()</code>返回的是'[object Boolean]'。
很明显 underscore 返回的是 true.</p> <h2 id="iselement"><a href="#iselement" class="header-anchor">#</a> isElement</h2> <blockquote><p>判断是否为 elements</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 判断是否为element</span>
<span class="token keyword">function</span> <span class="token function">isElement</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>让我们看看对创建 Element 判断是怎样</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isElement</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isElement</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="function-tagtester"><a href="#function-tagtester" class="header-anchor">#</a> function tagTester</h2> <blockquote><p>实际上就是对<code>Object.prototype.toString.call()</code>做了些不同返回的处理</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> tag <span class="token operator">=</span> <span class="token string">'[object '</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">']'</span>
  <span class="token comment">// `[object ${name}]` 个人觉得模板字符串更好看。</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> tag
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="isstring"><a href="#isstring" class="header-anchor">#</a> isString</h2> <blockquote><p>判断是否字符串，还需要验证下 new String()</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isString <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'String'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>验证下<code>new String()</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isString</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="isnumber"><a href="#isnumber" class="header-anchor">#</a> isNumber</h2> <blockquote><p>判断是否数字</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isNumber <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Number'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>验证下<code>new Number()</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isNumber</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="isdate"><a href="#isdate" class="header-anchor">#</a> isDate</h2> <blockquote><p>判断是否日期对象</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isDate <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>new Date()</code>既可以认为是对象，也可以认为是 Date。这个是没问题的。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="isregexp"><a href="#isregexp" class="header-anchor">#</a> isRegExp</h2> <blockquote><p>判断是否正则</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isRegExp <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'RegExp'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正则也是</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isRegExp</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isRegExp</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">moe</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isObject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="iserror"><a href="#iserror" class="header-anchor">#</a> isError</h2> <blockquote><p>判断是否报错</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isError <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Example'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Example'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isError</span><span class="token punctuation">(</span>err1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="issymbol"><a href="#issymbol" class="header-anchor">#</a> isSymbol</h2> <blockquote><p>判断是否 Symbol</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isSymbol <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Symbol'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isSymbol</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'symbol'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="isarraybuffer"><a href="#isarraybuffer" class="header-anchor">#</a> isArrayBuffer</h2> <blockquote><p>判断是否 isArrayBuffer</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isArrayBuffer <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'ArrayBuffer'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isSymbol</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> buffer<span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="isfunction"><a href="#isfunction" class="header-anchor">#</a> isFunction</h2> <blockquote><p>判断是否函数</p></blockquote> <p>isFunction$1 主要是解决部分老版本的 bug</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isFunction <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Function'</span><span class="token punctuation">)</span>

<span class="token comment">// Optimize `isFunction` if appropriate. Work around some `typeof` bugs in old</span>
<span class="token comment">// v8, IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).</span>
<span class="token keyword">var</span> nodelist <span class="token operator">=</span> root<span class="token punctuation">.</span>document <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>document<span class="token punctuation">.</span>childNodes
<span class="token keyword">if</span> <span class="token punctuation">(</span>
  <span class="token keyword">typeof</span> <span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">!=</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> Int8Array <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> nodelist <span class="token operator">!=</span> <span class="token string">'function'</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">isFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> isFunction$1 <span class="token operator">=</span> isFunction
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFunction</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> fn<span class="token punctuation">)</span> <span class="token comment">// 'function'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFunction</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> f<span class="token punctuation">)</span> <span class="token comment">// 'function'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="isdataview"><a href="#isdataview" class="header-anchor">#</a> isDataView</h2> <blockquote><p>判断是否 DataView，DataView 视图是一个可以从二进制 ArrayBuffer 对象中读写多种数值类型的底层接口，使用它时，不用考虑不同平台的字节序（endianness）问题。</p></blockquote> <p>正常有 DataView 的浏览器，isDataView 的判断就能满足</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isDataView <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'DataView'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>那么整体实现还需做哪些兼容性判断呢？先看看下面的二元运算：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isDataView$1 <span class="token operator">=</span> hasStringTagBug <span class="token operator">?</span> ie10IsDataView <span class="token operator">:</span> isDataView
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>supportsDataView</code>:<code>typeof DataView !== 'undefined'</code>也就是<code>DataView</code>不等于<code>undefined</code>;</p> <p><code>hasObjectTag</code>:是判断<code>new DataView(new ArrayBuffer(8)</code>是否对象。</p> <p>如果二者都满足就取<code>ie10IsDataView</code>,否则就正常返回<code>isDataView</code>。</p> <p>我们先看看<code>new DataView(new ArrayBuffer(8)</code>在 chrome 和 edge 的返回：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// chrome: 返回 '[object Object]'</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// edge: 返回 '[object DataView]'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在 chrome 打印是<code>'[object Object]'</code>还需要排除几个属于 object 类型的数据。也就是下面介绍的<code>ie10IsDataView</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">ie10IsDataView</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isFunction$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>getInt8<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isArrayBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>buffer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>不难看出，排除了<code>null</code>的干扰：<code>obj!=null</code>;</li> <li><code>getInt8</code>是<code>DataView</code>携带的方法。</li> <li><code>buffer</code> 属性描述了在构造时被 <code>DataView</code>引用的 <code>ArrayBuffer</code>。</li></ul> <p>后续的<code>isFunction$1(obj.getInt8) &amp;&amp; isArrayBuffer(obj.buffer)</code>，运用<code>DataView</code>的独特方法和属性结合来判断。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> supportsArrayBuffer <span class="token operator">=</span> <span class="token keyword">typeof</span> ArrayBuffer <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
  supportsDataView <span class="token operator">=</span> <span class="token keyword">typeof</span> DataView <span class="token operator">!==</span> <span class="token string">'undefined'</span>
<span class="token keyword">var</span> hasObjectTag <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Object'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> isDataView <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'DataView'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> hasStringTagBug <span class="token operator">=</span>
    supportsDataView <span class="token operator">&amp;&amp;</span> <span class="token function">hasObjectTag</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataView</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  isIE11 <span class="token operator">=</span> <span class="token keyword">typeof</span> Map <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasObjectTag</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// In IE 10 - Edge 13, we need a different heuristic</span>
<span class="token comment">// to determine whether an object is a `DataView`.</span>
<span class="token comment">// 也就是在chrome打印出来的是'[object Object]'，所以还需排出相应数据。</span>
<span class="token keyword">function</span> <span class="token function">ie10IsDataView</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isFunction$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>getInt8<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isArrayBuffer</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>buffer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> isDataView$1 <span class="token operator">=</span> hasStringTagBug <span class="token operator">?</span> ie10IsDataView <span class="token operator">:</span> isDataView
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="isarray"><a href="#isarray" class="header-anchor">#</a> isArray</h2> <blockquote><p>判断是否数组</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> nativeIsArray <span class="token operator">=</span> Array<span class="token punctuation">.</span>isArray
<span class="token comment">// Delegates to ECMA5's native `Array.isArray`.</span>
<span class="token keyword">var</span> isArray <span class="token operator">=</span> nativeIsArray <span class="token operator">||</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Array'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>运用<code>Array.isArray</code>和<code>Object.prototype.toString.call()</code>结合判断 Array</p> <p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// new Array()到底是对象还是数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [object Array]</span>

<span class="token comment">// Array(1) 是对象还是数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [empty]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'object'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [object Array]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="isfunction-2"><a href="#isfunction-2" class="header-anchor">#</a> isFunction</h2> <blockquote><p>判断是否函数</p></blockquote> <p>还是运用<code>Object.prototype.toString.call()</code>来判断是否函数。</p> <p>然后对老版本进行处理。如果在老版本返回的是<code>typeof obj == 'function'</code> 就被认为是函数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isFunction <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Function'</span><span class="token punctuation">)</span>

<span class="token comment">// Optimize `isFunction` if appropriate. Work around some `typeof` bugs in old</span>
<span class="token comment">// v8, IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).</span>
<span class="token comment">// 处理老版本函数返回</span>
<span class="token keyword">var</span> nodelist <span class="token operator">=</span> root<span class="token punctuation">.</span>document <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>document<span class="token punctuation">.</span>childNodes
<span class="token keyword">if</span> <span class="token punctuation">(</span>
  <span class="token keyword">typeof</span> <span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">!=</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> Int8Array <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> nodelist <span class="token operator">!=</span> <span class="token string">'function'</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">isFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> isFunction$1 <span class="token operator">=</span> isFunction
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="isarguments"><a href="#isarguments" class="header-anchor">#</a> isArguments</h2> <blockquote><p>isArguments(object), 如果 object 是一个参数对象，返回 true。</p></blockquote> <ul><li>首先，<code>var isArguments = tagTester('Arguments')</code>就已经返回 <code>true</code> 或者 <code>false</code> 了。这里返回 true 后不做任何处理。但是如果返回 false,就会往后执行</li> <li>然后，后面的函数<code>has$1</code>是判断原型上是否有<code>callee</code>属性。这里也是为了兼容 IE 小于 9 的版本。</li> <li>后面的自调用函数，主要是对 <code>!isArguments</code>的判断做了重新赋值，从而处理老版本的<code>arguments</code>的判断.</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isArguments <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Arguments'</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">has$1</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Define a fallback version of the method in browsers (ahem, IE &lt; 9), where</span>
<span class="token comment">// there isn't any inspectable &quot;Arguments&quot; type.</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isArguments</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">isArguments</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">has$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'callee'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> isArguments$1 <span class="token operator">=</span> isArguments
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isArguments</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">.</span><span class="token function">isArguments</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment">// false true</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// false true</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// false true</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token comment">// false true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="isfinite"><a href="#isfinite" class="header-anchor">#</a> isFinite</h2> <blockquote><p>判断有限的数字</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> _isFinite <span class="token operator">=</span> isFinite
<span class="token comment">// Is a given object a finite number?</span>
<span class="token keyword">function</span> <span class="token function">isFinite$1</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">isSymbol</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">_isFinite</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>不是<code>Symbol</code>类型</li> <li><code>isFinite</code>处理返回<code>true</code></li> <li>用<code>parseFloat</code>处理后不是<code>NaN</code></li></ul> <p>三个条件必须同时满足。</p> <p>示例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token comment">// 3.141592653589793</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="isnan"><a href="#isnan" class="header-anchor">#</a> isNaN</h2> <blockquote><p>判断是否为<code>NaN</code></p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> _isNaN <span class="token operator">=</span> isNaN
<span class="token keyword">function</span> <span class="token function">isNaN$1</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">isNumber</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">_isNaN</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>是 <code>Number</code>类型并且<code>isNaN</code>返回需要为<code>true</code></p> <p>示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="istypedarray"><a href="#istypedarray" class="header-anchor">#</a> isTypedArray</h2> <blockquote></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Modern feature detection.</span>
<span class="token keyword">var</span> supportsArrayBuffer <span class="token operator">=</span> <span class="token keyword">typeof</span> ArrayBuffer <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
  supportsDataView <span class="token operator">=</span> <span class="token keyword">typeof</span> DataView <span class="token operator">!==</span> <span class="token string">'undefined'</span>
<span class="token keyword">var</span> nativeIsView <span class="token operator">=</span> supportsArrayBuffer <span class="token operator">&amp;&amp;</span> ArrayBuffer<span class="token punctuation">.</span>isView
<span class="token keyword">var</span> typedArrayPattern <span class="token operator">=</span>
  <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">function</span> <span class="token function">isTypedArray</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// `ArrayBuffer.isView` is the most future-proof, so use it when available.</span>
  <span class="token comment">// Otherwise, fall back on the above regular expression.</span>
  <span class="token keyword">return</span> nativeIsView
    <span class="token operator">?</span> <span class="token function">nativeIsView</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isDataView$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">isBufferLike</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> typedArrayPattern<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> isTypedArray$1 <span class="token operator">=</span> supportsArrayBuffer <span class="token operator">?</span> isTypedArray <span class="token operator">:</span> <span class="token function">constant</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="isempty"><a href="#isempty" class="header-anchor">#</a> isEmpty</h2> <blockquote><p><em>.isEmpty(object)
如果 object 不包含任何值(没有可枚举的属性)，返回 true。 对于字符串和类数组（array-like）对象，如果 length 属性为 0，那么</em>.isEmpty 检查返回 true。</p></blockquote> <p>函数<code>shallowProperty</code>主要是获取对象的属性。<code>getLength</code>实际上就是获取对象的<code>length</code>属性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">:</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Internal helper to obtain the `length` property of an object.</span>
<span class="token keyword">var</span> getLength <span class="token operator">=</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token string">'length'</span><span class="token punctuation">)</span>
<span class="token comment">// Is a given array, string, or object empty?</span>
<span class="token comment">// An &quot;empty&quot; object has no enumerable own-properties.</span>
<span class="token keyword">function</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token comment">// Skip the more expensive `toString`-based type checks if `obj` has no</span>
  <span class="token comment">// `.length`.</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> <span class="token function">getLength</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token keyword">typeof</span> length <span class="token operator">==</span> <span class="token string">'number'</span> <span class="token operator">&amp;&amp;</span>
    <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isString</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isArguments$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
    <span class="token keyword">return</span> length <span class="token operator">===</span> <span class="token number">0</span>
  <span class="token keyword">return</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>示例：</p> <blockquote><p>数组的长度不为空，内部为空，在 underscore 认为不是空。（Array(3), [, , ,]）</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  _<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token comment">// false true false false true</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// [empty × 3] [empty × 3]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="ismatch"><a href="#ismatch" class="header-anchor">#</a> isMatch</h2> <blockquote><p>键和值是否包含</p></blockquote> <p>下面的代码，我们先直接分析主函数。然后在一个个去看其他函数是什么意思。</p> <p>首先在<code>object==null</code>时， 直接返回!length。这是上半部分。<br>
下半部分则是直接遍历获取_keys，看遍历返回的 key 是否在对象里。如果有一个不在就会直接返回 false，全部都在的话就会全部返回 true.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isMatch</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _keys <span class="token operator">=</span> <span class="token function">keys</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">,</span>
    length <span class="token operator">=</span> _keys<span class="token punctuation">.</span>length <span class="token comment">//</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">!</span>length <span class="token comment">//如果传入对象为null 直接返回!length。</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> _keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>接下来我们看看<code>keys</code>到底对 attrs 做了什么处理。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">keys</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nativeKeys<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">nativeKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">has$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token comment">// Ahem, IE &lt; 9.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hasEnumBug<span class="token punctuation">)</span> <span class="token function">collectNonEnumProps</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> keys<span class="token punctuation">)</span>
  <span class="token keyword">return</span> keys
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol><li>第一种情况：如果 attrs 不是对象就会返回空数组。在<code>return !length</code>就会直接返回 true。</li> <li>第二种情况：如果 存在<code>nativeKeys</code>也就是<code>var nativeKeys = Object.keys</code>.Object.keys() 静态方法返回一个由给定对象自身的可枚举的字符串键属性名组成的数组。其实也是返回的属性名组成的数组。</li> <li>第三种情况：正常遍历对象。通过<code>has$1(obj, key)</code>，也就是<code>Object.prototype.hasOwnProperty()</code>。hasOwnProperty() 方法返回一个布尔值，表示对象自有属性（而不是继承来的属性）中是否具有指定的属性。将对象的自有属性名放到数组中。</li> <li>第四种情况：对 ie 出现 bug 的特殊处理<code>// Ahem, IE &lt; 9.if (hasEnumBug) collectNonEnumProps(obj, keys)</code>。</li></ol> <p>上述这四种情况，总结来说就是把自有属性，全部放在数组中，通过<code>keys</code>函数返回。后续只是通过遍历<code>_keys</code>，看<code>attrs</code>中的自有属性是否都在 obj 中存在。都存在返回 true，有一个不存在就返回 false。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> key <span class="token operator">=</span> _keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>源码部分</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果是null就返回void 0,否则返回对象的对应属性</span>
    <span class="token keyword">return</span> obj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">:</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Internal helper to obtain the `length` property of an object.</span>
<span class="token comment">// 为了获取对象的的长度</span>
<span class="token keyword">var</span> getLength <span class="token operator">=</span> <span class="token function">shallowProperty</span><span class="token punctuation">(</span><span class="token string">'length'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> nativeKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span>keys
<span class="token comment">// Keys in IE &lt; 9 that won't be iterated by `for key in ...` and thus missed.</span>
<span class="token keyword">var</span> hasEnumBug <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">{</span> <span class="token literal-property property">toString</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">propertyIsEnumerable</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> nonEnumerableProps <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'valueOf'</span><span class="token punctuation">,</span>
  <span class="token string">'isPrototypeOf'</span><span class="token punctuation">,</span>
  <span class="token string">'toString'</span><span class="token punctuation">,</span>
  <span class="token string">'propertyIsEnumerable'</span><span class="token punctuation">,</span>
  <span class="token string">'hasOwnProperty'</span><span class="token punctuation">,</span>
  <span class="token string">'toLocaleString'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">function</span> <span class="token function">has$1</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Internal helper to create a simple lookup structure.</span>
<span class="token comment">// `collectNonEnumProps` used to depend on `_.contains`, but this led to</span>
<span class="token comment">// circular imports. `emulatedSet` is a one-off solution that only works for</span>
<span class="token comment">// arrays of strings.</span>
<span class="token keyword">function</span> <span class="token function">emulatedSet</span><span class="token punctuation">(</span><span class="token parameter">keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> l <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> hash<span class="token punctuation">[</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">contains</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> hash<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">push</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      hash<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">return</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Internal helper. Checks `keys` for the presence of keys in IE &lt; 9 that won't</span>
<span class="token comment">// be iterated by `for key in ...` and thus missed. Extends `keys` in place if</span>
<span class="token comment">// needed.</span>
<span class="token keyword">function</span> <span class="token function">collectNonEnumProps</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  keys <span class="token operator">=</span> <span class="token function">emulatedSet</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span>
  <span class="token keyword">var</span> nonEnumIdx <span class="token operator">=</span> nonEnumerableProps<span class="token punctuation">.</span>length
  <span class="token keyword">var</span> constructor <span class="token operator">=</span> obj<span class="token punctuation">.</span>constructor
  <span class="token keyword">var</span> proto <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">isFunction$1</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token operator">||</span> ObjProto

  <span class="token comment">// Constructor is a special case.</span>
  <span class="token keyword">var</span> prop <span class="token operator">=</span> <span class="token string">'constructor'</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">has$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> prop<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>keys<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>nonEnumIdx<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prop <span class="token operator">=</span> nonEnumerableProps<span class="token punctuation">[</span>nonEnumIdx<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prop <span class="token keyword">in</span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">!==</span> proto<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>keys<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">keys</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nativeKeys<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">nativeKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">has$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token comment">// Ahem, IE &lt; 9.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hasEnumBug<span class="token punctuation">)</span> <span class="token function">collectNonEnumProps</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> keys<span class="token punctuation">)</span>
  <span class="token keyword">return</span> keys
<span class="token punctuation">}</span>
<span class="token comment">// Returns whether an object has a given set of `key:value` pairs.</span>
<span class="token keyword">function</span> <span class="token function">isMatch</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> attrs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _keys <span class="token operator">=</span> <span class="token function">keys</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">,</span>
    length <span class="token operator">=</span> _keys<span class="token punctuation">.</span>length
  <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">!</span>length
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> _keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><h2 id="isequal"><a href="#isequal" class="header-anchor">#</a> isEqual</h2> <blockquote><p>执行两个对象之间的优化深度比较，确定他们是否应被视为相等。</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Perform a deep comparison to check if two objects are equal.</span>
<span class="token keyword">function</span> <span class="token function">isEqual</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// If Underscore is called as a function, it returns a wrapped object that can</span>
<span class="token comment">// be used OO-style. This wrapper holds altered versions of all functions added</span>
<span class="token comment">// through `_.mixin`. Wrapped objects may be chained.</span>
<span class="token keyword">function</span> <span class="token function">_$1</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">_</span>$1<span class="token punctuation">)</span> <span class="token keyword">return</span> obj
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">_</span>$1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">_</span><span class="token function">$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>_wrapped <span class="token operator">=</span> obj
<span class="token punctuation">}</span>

<span class="token comment">// Internal recursive comparison function for `_.isEqual`.</span>
<span class="token keyword">function</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Unwrap any wrapped objects.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">instanceof</span> <span class="token class-name">_</span>$1<span class="token punctuation">)</span> a <span class="token operator">=</span> a<span class="token punctuation">.</span>_wrapped
  <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token keyword">instanceof</span> <span class="token class-name">_</span>$1<span class="token punctuation">)</span> b <span class="token operator">=</span> b<span class="token punctuation">.</span>_wrapped
  <span class="token comment">// Compare `[[Class]]` names.</span>
  <span class="token keyword">var</span> className <span class="token operator">=</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>className <span class="token operator">!==</span> <span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token comment">// Work around a bug in IE 10 - Edge 13.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hasStringTagBug <span class="token operator">&amp;&amp;</span> className <span class="token operator">==</span> <span class="token string">'[object Object]'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isDataView$1</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isDataView$1</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    className <span class="token operator">=</span> tagDataView
  <span class="token punctuation">}</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>className<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// These types are compared by value.</span>
    <span class="token keyword">case</span> <span class="token string">'[object RegExp]'</span><span class="token operator">:</span>
    <span class="token comment">// RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')</span>
    <span class="token keyword">case</span> <span class="token string">'[object String]'</span><span class="token operator">:</span>
      <span class="token comment">// Primitives and their corresponding object wrappers are equivalent; thus, `&quot;5&quot;` is</span>
      <span class="token comment">// equivalent to `new String(&quot;5&quot;)`.</span>
      <span class="token keyword">return</span> <span class="token string">''</span> <span class="token operator">+</span> a <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">+</span> b
    <span class="token keyword">case</span> <span class="token string">'[object Number]'</span><span class="token operator">:</span>
      <span class="token comment">// `NaN`s are equivalent, but non-reflexive.</span>
      <span class="token comment">// Object(NaN) is equivalent to NaN.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">+</span>a <span class="token operator">!==</span> <span class="token operator">+</span>a<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">+</span>b <span class="token operator">!==</span> <span class="token operator">+</span>b
      <span class="token comment">// An `egal` comparison is performed for other numeric values.</span>
      <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> b <span class="token operator">:</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b
    <span class="token keyword">case</span> <span class="token string">'[object Date]'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token string">'[object Boolean]'</span><span class="token operator">:</span>
      <span class="token comment">// Coerce dates and booleans to numeric primitive values. Dates are compared by their</span>
      <span class="token comment">// millisecond representations. Note that invalid dates with millisecond representations</span>
      <span class="token comment">// of `NaN` are not equivalent.</span>
      <span class="token keyword">return</span> <span class="token operator">+</span>a <span class="token operator">===</span> <span class="token operator">+</span>b
    <span class="token keyword">case</span> <span class="token string">'[object Symbol]'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> SymbolProto<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">===</span> SymbolProto<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token string">'[object ArrayBuffer]'</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token literal-property property">tagDataView</span><span class="token operator">:</span>
      <span class="token comment">// Coerce to typed array so we can fall through.</span>
      <span class="token keyword">return</span> <span class="token function">deepEq</span><span class="token punctuation">(</span><span class="token function">toBufferView</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">toBufferView</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> areArrays <span class="token operator">=</span> className <span class="token operator">===</span> <span class="token string">'[object Array]'</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>areArrays <span class="token operator">&amp;&amp;</span> <span class="token function">isTypedArray$1</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> byteLength <span class="token operator">=</span> <span class="token function">getByteLength</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>byteLength <span class="token operator">!==</span> <span class="token function">getByteLength</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>buffer <span class="token operator">===</span> b<span class="token punctuation">.</span>buffer <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>byteOffset <span class="token operator">===</span> b<span class="token punctuation">.</span>byteOffset<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
    areArrays <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> b <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>

    <span class="token comment">// Objects with different constructors are not equivalent, but `Object`s or `Array`s</span>
    <span class="token comment">// from different frames are.</span>
    <span class="token keyword">var</span> aCtor <span class="token operator">=</span> a<span class="token punctuation">.</span>constructor<span class="token punctuation">,</span>
      bCtor <span class="token operator">=</span> b<span class="token punctuation">.</span>constructor
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      aCtor <span class="token operator">!==</span> bCtor <span class="token operator">&amp;&amp;</span>
      <span class="token operator">!</span><span class="token punctuation">(</span>
        <span class="token function">isFunction$1</span><span class="token punctuation">(</span>aCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        aCtor <span class="token keyword">instanceof</span> <span class="token class-name">aCtor</span> <span class="token operator">&amp;&amp;</span>
        <span class="token function">isFunction$1</span><span class="token punctuation">(</span>bCtor<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        bCtor <span class="token keyword">instanceof</span> <span class="token class-name">bCtor</span>
      <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
      <span class="token string">'constructor'</span> <span class="token keyword">in</span> a <span class="token operator">&amp;&amp;</span>
      <span class="token string">'constructor'</span> <span class="token keyword">in</span> b
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Assume equality for cyclic structures. The algorithm for detecting cyclic</span>
  <span class="token comment">// structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.</span>

  <span class="token comment">// Initializing stack of traversed objects.</span>
  <span class="token comment">// It's done here since we only need them for objects and arrays comparison.</span>
  aStack <span class="token operator">=</span> aStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  bStack <span class="token operator">=</span> bStack <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> aStack<span class="token punctuation">.</span>length
  <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Linear search. Performance is inversely proportional to the number of</span>
    <span class="token comment">// unique nested structures.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>aStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> a<span class="token punctuation">)</span> <span class="token keyword">return</span> bStack<span class="token punctuation">[</span>length<span class="token punctuation">]</span> <span class="token operator">===</span> b
  <span class="token punctuation">}</span>

  <span class="token comment">// Add the first object to the stack of traversed objects.</span>
  aStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  bStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>

  <span class="token comment">// Recursively compare objects and arrays.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>areArrays<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Compare array lengths to determine if a deep comparison is necessary.</span>
    length <span class="token operator">=</span> a<span class="token punctuation">.</span>length
    <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">!==</span> b<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token comment">// Deep compare the contents, ignoring non-numeric properties.</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Deep compare objects.</span>
    <span class="token keyword">var</span> _keys <span class="token operator">=</span> <span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>
      key
    length <span class="token operator">=</span> _keys<span class="token punctuation">.</span>length
    <span class="token comment">// Ensure that both objects contain the same number of properties before comparing deep equality.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">keys</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">!==</span> length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>length<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Deep compare each member</span>
      key <span class="token operator">=</span> _keys<span class="token punctuation">[</span>length<span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">has$1</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">eq</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> aStack<span class="token punctuation">,</span> bStack<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Remove the first object from the stack of traversed objects.</span>
  aStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  bStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br></div></div><h2 id="ismap"><a href="#ismap" class="header-anchor">#</a> isMap</h2> <blockquote><p>判断是否 是一个 Map 数据结构</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> isFunction <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Function'</span><span class="token punctuation">)</span>

<span class="token comment">// Optimize `isFunction` if appropriate. Work around some `typeof` bugs in old</span>
<span class="token comment">// v8, IE 11 (#1621), Safari 8 (#1929), and PhantomJS (#2236).</span>
<span class="token comment">// 处理老版本函数返回</span>
<span class="token keyword">var</span> nodelist <span class="token operator">=</span> root<span class="token punctuation">.</span>document <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>document<span class="token punctuation">.</span>childNodes
<span class="token keyword">if</span> <span class="token punctuation">(</span>
  <span class="token keyword">typeof</span> <span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">!=</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> Int8Array <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span>
  <span class="token keyword">typeof</span> nodelist <span class="token operator">!=</span> <span class="token string">'function'</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">isFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> isFunction$1 <span class="token operator">=</span> isFunction
<span class="token comment">// Since the regular `Object.prototype.toString` type tests don't work for</span>
<span class="token comment">// some types in IE 11, we use a fingerprinting heuristic instead, based</span>
<span class="token comment">// on the methods. It's not great, but it's the best we got.</span>
<span class="token comment">// The fingerprint method lists are defined below.</span>
<span class="token keyword">function</span> <span class="token function">ie11fingerprint</span><span class="token punctuation">(</span><span class="token parameter">methods</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> <span class="token function">getLength</span><span class="token punctuation">(</span>methods<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token comment">// `Map`, `WeakMap` and `Set` have no enumerable keys.</span>
    <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token function">allKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getLength</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isFunction$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>methods<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// If we are testing against `WeakMap`, we need to ensure that</span>
    <span class="token comment">// `obj` doesn't have a `forEach` method in order to distinguish</span>
    <span class="token comment">// it from a regular `Map`.</span>
    <span class="token keyword">return</span> methods <span class="token operator">!==</span> weakMapMethods <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isFunction$1</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>forEachName<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// In the interest of compact minification, we write</span>
<span class="token comment">// each string in the fingerprints only once.</span>
<span class="token keyword">var</span> forEachName <span class="token operator">=</span> <span class="token string">'forEach'</span><span class="token punctuation">,</span>
  hasName <span class="token operator">=</span> <span class="token string">'has'</span><span class="token punctuation">,</span>
  commonInit <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  mapTail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> hasName<span class="token punctuation">,</span> <span class="token string">'set'</span><span class="token punctuation">]</span>
<span class="token comment">// `Map`, `WeakMap` and `Set` each have slightly different</span>
<span class="token comment">// combinations of the above sublists.</span>
<span class="token keyword">var</span> mapMethods <span class="token operator">=</span> commonInit<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>forEachName<span class="token punctuation">,</span> mapTail<span class="token punctuation">)</span><span class="token punctuation">,</span>
  weakMapMethods <span class="token operator">=</span> commonInit<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>mapTail<span class="token punctuation">)</span><span class="token punctuation">,</span>
  setMethods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>commonInit<span class="token punctuation">,</span> forEachName<span class="token punctuation">,</span> hasName<span class="token punctuation">)</span>
<span class="token keyword">var</span> hasObjectTag <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Object'</span><span class="token punctuation">)</span>
<span class="token comment">// 通过Map!==undefined并且，new Map()是对象，来判断isIE11</span>
<span class="token keyword">var</span> isIE11 <span class="token operator">=</span> <span class="token keyword">typeof</span> Map <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasObjectTag</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> isMap <span class="token operator">=</span> isIE11 <span class="token operator">?</span> <span class="token function">ie11fingerprint</span><span class="token punctuation">(</span>mapMethods<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Map'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> isWeakMap <span class="token operator">=</span> isIE11 <span class="token operator">?</span> <span class="token function">ie11fingerprint</span><span class="token punctuation">(</span>weakMapMethods<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'WeakMap'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> isSet <span class="token operator">=</span> isIE11 <span class="token operator">?</span> <span class="token function">ie11fingerprint</span><span class="token punctuation">(</span>setMethods<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'Set'</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> isWeakSet <span class="token operator">=</span> <span class="token function">tagTester</span><span class="token punctuation">(</span><span class="token string">'WeakSet'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>上面都是利用<code>Object.prototype.toString.call()</code>判断其类型。</p> <p>通过<code>Map!==undefined</code>并且，<code>new Map()</code>是对象，来判断是否在 ie11 环境。isIE11。</p> <p>而<code>commonInit</code>是将所有的原型方法进行组合，例如 set 的‘add’和‘has’方法。</p> <h2 id="isweakmap"><a href="#isweakmap" class="header-anchor">#</a> isWeakMap</h2> <blockquote><p>判断是否 是一个 isWeakMap 数据结构</p></blockquote> <h2 id="isset"><a href="#isset" class="header-anchor">#</a> isSet</h2> <blockquote><p>判断是否 是一个 isSet 数据结构</p></blockquote> <h2 id="isweakset"><a href="#isweakset" class="header-anchor">#</a> isWeakSet</h2> <blockquote><p>判断是否 是一个 isWeakSet 数据结构</p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2024-3-26 10:33:25 ├F10: AM┤</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/underscore-analysis/familiar/" class="prev router-link-active">
        前言
      </a></span> <span class="next"><a href="/underscore-analysis/familiar/restArguments.html">
        restArguments
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/underscore-analysis/assets/js/app.e2005051.js" defer></script><script src="/underscore-analysis/assets/js/2.f865bfe5.js" defer></script><script src="/underscore-analysis/assets/js/1.33f930c5.js" defer></script><script src="/underscore-analysis/assets/js/26.c97d25ce.js" defer></script>
  </body>
</html>
